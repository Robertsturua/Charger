<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Information Form</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 720px; margin: 40px auto; padding: 0 16px; }
    label { display:block; margin-top: 14px; font-weight: 600; }
    input, select, button { width: 100%; padding: 10px; margin-top: 6px; box-sizing: border-box; }
    .row { display:grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    .hint { font-size: 0.9rem; opacity: 0.8; }
    .numbers-box { padding: 10px; border: 1px solid #ccc; border-radius: 6px; margin-top: 6px; font-size: 1.2rem; letter-spacing: 2px; }
    .error { color: #b00020; margin-top: 10px; }
    .success { color: #0a7a0a; margin-top: 10px; }
    button { cursor: pointer; margin-top: 18px; }
  </style>
</head>
<body>

  <h1>Enter your information</h1>

  <form id="infoForm">
    <label for="fullName">Name and surname</label>
    <input id="fullName" name="fullName" type="text" required />

    <div class="row">
      <div>
        <label for="age">Age</label>
        <input id="age" name="age" type="number" min="0" max="130" required />
      </div>
      <div>
        <label for="country">Country</label>
        <select id="country" name="country" required>
          <option value="" disabled selected>Select a country</option>
          <option>Albania</option>
          <option>Andorra</option>
          <option>Austria</option>
          <option>Belarus</option>
          <option>Belgium</option>
          <option>Bosnia and Herzegovina</option>
          <option>Bulgaria</option>
          <option>Croatia</option>
          <option>Cyprus</option>
          <option>Czechia</option>
          <option>Denmark</option>
          <option>Estonia</option>
          <option>Finland</option>
          <option>France</option>
          <option>Germany</option>
          <option>Greece</option>
          <option>Hungary</option>
          <option>Iceland</option>
          <option>Ireland</option>
          <option>Italy</option>
          <option>Kosovo</option>
          <option>Latvia</option>
          <option>Liechtenstein</option>
          <option>Lithuania</option>
          <option>Luxembourg</option>
          <option>Malta</option>
          <option>Moldova</option>
          <option>Monaco</option>
          <option>Montenegro</option>
          <option>Netherlands</option>
          <option>North Macedonia</option>
          <option>Norway</option>
          <option>Poland</option>
          <option>Portugal</option>
          <option>Romania</option>
          <option>Russia</option>
          <option>San Marino</option>
          <option>Serbia</option>
          <option>Slovakia</option>
          <option>Slovenia</option>
          <option>Spain</option>
          <option>Sweden</option>
          <option>Switzerland</option>
          <option>Turkey</option>
          <option>Ukraine</option>
          <option>United Kingdom</option>
          <option>Vatican City</option>
        </select>
      </div>
    </div>

    <label for="address">Address</label>
    <input id="address" name="address" type="text" required />

    <div class="row">
      <div>
        <label for="zipcode">Zipcode / Postcode</label>
        <input id="zipcode" name="zipcode" type="text" required />
      </div>
      <div>
        <label for="phone">Phone number</label>
        <input id="phone" name="phone" type="tel" required placeholder="+44..." />
        <div class="hint">Tip: include country code (e.g. +44)</div>
      </div>
    </div>

    <label>Type these 10 numbers to confirm</label>
    <div id="numbersToType" class="numbers-box"></div>
    <input id="confirmNumbers" name="confirmNumbers" type="text" inputmode="numeric" autocomplete="off" required />

    <div id="msg" class=""></div>

    <button type="submit" id="submitBtn">Submit</button>
  </form>

  <script>
    const WEB_APP_URL = "PASTE_YOUR_WEB_APP_URL_HERE"; // <-- replace

    const numbersBox = document.getElementById("numbersToType");
    const confirmInput = document.getElementById("confirmNumbers");
    const form = document.getElementById("infoForm");
    const msg = document.getElementById("msg");
    const submitBtn = document.getElementById("submitBtn");

    // Generate 10 random digits
    function generateDigits(len = 10) {
      let s = "";
      for (let i = 0; i < len; i++) s += Math.floor(Math.random() * 10);
      return s;
    }

    let challenge = generateDigits(10);
    numbersBox.textContent = challenge;

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      msg.className = "";
      msg.textContent = "";

      const typed = (confirmInput.value || "").trim();

      // must match exactly the digits shown
      if (typed !== challenge) {
        msg.className = "error";
        msg.textContent = "The 10 numbers do not match. Please try again.";
        // New digits for next try (optional)
        challenge = generateDigits(10);
        numbersBox.textContent = challenge;
        confirmInput.value = "";
        confirmInput.focus();
        return;
      }

      // Prepare payload
      const payload = {
        fullName: document.getElementById("fullName").value.trim(),
        age: document.getElementById("age").value.trim(),
        country: document.getElementById("country").value,
        address: document.getElementById("address").value.trim(),
        zipcode: document.getElementById("zipcode").value.trim(),
        phone: document.getElementById("phone").value.trim(),
        confirmNumbers: typed
      };

      submitBtn.disabled = true;
      submitBtn.textContent = "Submitting...";

      try {
        const res = await fetch(WEB_APP_URL, {
          method: "POST",
          headers: { "Content-Type": "text/plain;charset=utf-8" },
          body: JSON.stringify(payload)
        });

        const json = await res.json();

        if (json.ok) {
          // Go to thank you page
          window.location.href = "thankyou.html";
        } else {
          msg.className = "error";
          msg.textContent = "Error saving your data: " + (json.error || "Unknown error");
          submitBtn.disabled = false;
          submitBtn.textContent = "Submit";
        }

      } catch (err) {
        msg.className = "error";
        msg.textContent = "Network error: " + err;
        submitBtn.disabled = false;
        submitBtn.textContent = "Submit";
      }
    });
  </script>

</body>
</html>
